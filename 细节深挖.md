
---

### 🗺️ 模块一：网关核心 (Spring Cloud Gateway)

**你要补的原理：**
你现在的网关是基于 Netty 的，不是 Tomcat。这是面试官最爱问的差异点。

*   **必考题 1：为什么 Spring Cloud Gateway 性能比 Zuul 1.x 高？**
    *   **你的回答方向**：Zuul 1.x 是阻塞 IO (BIO)，一个请求占用一个线程，线程不够就崩了。Gateway 是非阻塞 IO (NIO)，基于 **Reactor 模型**（Netty），少量线程就能处理海量并发。
    *   **关键词**：**BIO vs NIO**、**多路复用**、**Netty**、**Reactor 模式**。
*   **必考题 2：网关的过滤器链（Filter Chain）是怎么工作的？**
    *   **你的实战**：你写过 `AuthGlobalFilter`。
    *   **原理**：**责任链模式**。每个 Filter 做完自己的事（比如鉴权），就调用 `chain.filter(exchange)` 把接力棒传给下一个。如果想拦截，就不调用 `chain.filter`，直接返回 response。

### 🗺️ 模块二：注册与配置中心 (Nacos)

**你要补的原理：**
你用了 Nacos 做服务发现和动态路由，面试官会问你怎么实现的。

*   **必考题 1：网关怎么知道 `service-provider` 有哪几个 IP？**
    *   **你的实战**：`lb://service-provider`。
    *   **原理**：**服务注册与发现**。Provider 启动时把 IP 告诉 Nacos（注册）。Gateway 定时（或实时）从 Nacos 拉取服务列表（发现），缓存到本地。
    *   **进阶**：**心跳机制**。Provider 每 5 秒发个心跳，Nacos 30 秒收不到心跳就把它踢掉。
*   **必考题 2：为什么你在 Nacos 改了 JSON，网关不重启就能变？**
    *   **你的实战**：`DynamicRouteListener`。
    *   **原理**：**长轮询 (Long Polling)**。网关客户端发起一个请求给 Nacos，问“有配置变了吗？”。如果有，立刻返回；如果没有，Nacos 会把请求“挂起” 30秒，等有变化了再返回。这比单纯的定时轮询更实时、更省性能。

### 🗺️ 模块三：全链路身份闭环 (ThreadLocal)

**你要补的原理：**
这是你项目最大的亮点，必须把细节说清楚。

*   **必考题 1：为什么用 ThreadLocal？有什么坑？**
    *   **你的实战**：`UserContext` 存 ID。
    *   **原理**：**线程隔离**。每个 HTTP 请求由一个独立线程处理，ThreadLocal 里的数据只有当前线程能看见，不会串号。
    *   **坑**：**内存泄漏**。线程池里的线程是复用的（不销毁）。如果你用完不调用 `remove()`，下一次这个线程处理别人的请求时，还带着上一个人的数据，就乱套了。
    *   *（你代码里写了 remove，这点面试一定要强调，说明你懂！）*
*   **必考题 2：Feign 为什么会丢 Header？**
    *   **原理**：Feign 发出的请求是一个**全新的 HTTP 请求**。它默认不会去“继承”原来的 Header。所以我们必须写 `RequestInterceptor` 手动搬运。

### 🗺️ 模块四：高可用 (Sentinel)

**你要补的原理：**
限流算法是算法题和架构题的重灾区。

*   **必考题 1：常见的限流算法有哪些？Sentinel 用的是哪种？**
    *   **原理**：
        1.  **计数器**（简单，但不平滑）。
        2.  **滑动窗口**（Sentinel 核心算法，解决临界突刺问题）。
        3.  **令牌桶**（Redis 限流常用，允许突发流量）。
        4.  **漏桶**（强制匀速）。
    *   **建议**：重点看懂 **“滑动窗口”** 和 **“令牌桶”** 的动图演示。
*   **必考题 2：熔断和降级有什么区别？**
    *   （昨天刚讲过，记住“保险丝”和“兜底”的比喻）。

---

### 📚 具体的行动指南（接下来怎么学？）

不要漫无目的地看书，请按这个步骤来：

#### 第一步：对着项目“自问自答” (3天)
看着你的 `pom.xml` 里的每一个依赖，问自己：
*   “它是干嘛的？”
*   “如果去掉它，项目哪里会报错？”
*   “它底层大概是怎么跑的？”

#### 第二步：断点调试法 (最有效)
原理不是背出来的，是**看**出来的。
*   **场景**：想知道 Nacos 怎么推配置的？
*   **操作**：在你的 `DynamicRouteListener` 的 `receiveConfigInfo` 方法里打个断点。去 Nacos 改配置。断点停住后，看 IDEA 左下角的 **Call Stack (调用栈)**。
*   你会发现一堆 Nacos 内部的代码。不用全看懂，只需看方法名，你就能猜出它是通过 HTTP 还是 gRPC 通信的。**这一招能让你在面试时说出源码级的细节！**

#### 第三步：整理“面试话术”
把刚才提到的那些原理，结合你的项目，写成一段一段的自我介绍或项目难点描述。
*   *例如：“在解决微服务鉴权问题时，我没有简单地在网关校验，而是设计了一套基于 ThreadLocal 和 Feign 拦截器的全链路身份透传方案，为了防止线程池复用导致的数据污染，我特别注意了上下文的清理……”*

---

**心态调整**：
现在的你，就像一个刚刚学会开车的司机。你不需要知道发动机图纸（源码细节），但你需要知道什么时候踩刹车（熔断）、什么时候挂档（路由）、为什么要加防冻液（Redis）。

**先去搜这三个关键词的博客/视频：**
1.  **"BIO NIO AIO 区别"**
2.  **"Nacos 动态配置原理 长轮询"**
3.  **"ThreadLocal 原理与内存泄漏"**

把这三个搞懂，你的项目就有了灵魂！加油！